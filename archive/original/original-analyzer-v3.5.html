<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A1 Evo Ultimate Analyzer v3.5</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Rajdhani:wght@500;600;700&family=Noto+Sans+TC:wght@400;700&family=Noto+Sans+JP:wght@400;700&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #0f172a;
            --bg-panel: rgba(30, 41, 59, 0.7);
            --bg-upload: rgba(15, 23, 42, 0.3);
            --c-primary: #38bdf8;
            --c-secondary: #818cf8;
            --c-success: #4ade80;
            --c-warning: #fbbf24;
            --c-danger: #f87171;
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --border-glass: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(56, 189, 248, 0.3);
            --shadow-glow: rgba(56, 189, 248, 0.1);
            --bg-table-head: rgba(56, 189, 248, 0.05);
            --bg-table-hover: rgba(56, 189, 248, 0.03);
            --bg-sw-row: rgba(129, 140, 248, 0.1);
            --bg-avg-row: rgba(56, 189, 248, 0.1);
        }

        body {
            background-color: var(--bg-body);
            background-image: 
                radial-gradient(circle at 15% 50%, var(--c-secondary) 0%, transparent 25%),
                radial-gradient(circle at 85% 30%, var(--c-primary) 0%, transparent 25%),
                linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
            background-size: 100% 100%, 100% 100%, 40px 40px, 40px 40px;
            background-attachment: fixed;
            color: var(--text-main);
            font-family: 'Rajdhani', 'Noto Sans TC', 'Noto Sans JP', 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 20px;
            transition: all 0.5s ease;
        }

        .container { max-width: 1600px; margin: 0 auto; position: relative; }

        /* Controls Area */
        .controls-bar {
            position: absolute; top: 0; right: 0; z-index: 100;
            display: flex; gap: 10px;
        }
        select.ui-select {
            background: var(--bg-panel); color: var(--text-main);
            border: 1px solid var(--c-primary);
            padding: 8px 12px; border-radius: 8px;
            font-family: 'Rajdhani', sans-serif; font-weight: 600;
            cursor: pointer; outline: none;
            backdrop-filter: blur(10px);
        }

        /* Typography & Bilingual Logic */
        .lang-primary { font-family: 'Noto Sans TC', 'Noto Sans JP', 'Noto Sans KR', sans-serif; font-weight: 700; display: block; font-size: 1.1em; letter-spacing: 0.5px; }
        .lang-sub { font-family: 'Rajdhani', sans-serif; font-weight: 500; display: block; font-size: 0.8em; color: var(--text-sub); text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }
        .mono { font-family: 'JetBrains Mono', monospace; }

        body.lang-en .lang-primary { font-family: 'Rajdhani', sans-serif; font-size: 1em; }
        body.lang-en .lang-sub { /*display: none;*/ }

        /* Header */
        header {
            text-align: center; margin-bottom: 40px; position: relative; padding-bottom: 25px;
            border-bottom: 1px solid var(--border-glass);
        }
        header::after {
            content: ''; position: absolute; bottom: -1px; left: 50%; transform: translateX(-50%);
            width: 300px; height: 2px;
            background: linear-gradient(90deg, transparent, var(--c-primary), var(--c-secondary), transparent);
            box-shadow: 0 0 10px var(--c-primary); opacity: 0.7;
        }
        .title-main {
            font-size: 2.8rem; font-weight: 700; color: var(--text-main);
            text-shadow: 0 0 20px var(--shadow-glow);
            font-family: 'Rajdhani', sans-serif; letter-spacing: 4px;
            transition: color 0.5s;
        }
        .title-sub { color: var(--c-secondary); letter-spacing: 6px; font-size: 0.9rem; margin-top: 5px; font-weight: 600; opacity: 0.9; }

        /* Panels */
        .glass-panel {
            background: var(--bg-panel);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--border-glass); border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            transition: all 0.5s ease;
        }
        .glass-panel:hover { border-color: var(--border-hover); }

        /* Pro Stats Panel */
        .pro-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(145deg, var(--bg-panel), rgba(255,255,255,0.02));
            border: 1px solid var(--border-glass);
            border-top: 2px solid var(--c-primary);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(12px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 0%, var(--shadow-glow), transparent 70%);
            opacity: 0.5; pointer-events: none;
        }
        .stat-icon { font-size: 1.5rem; margin-bottom: 5px; opacity: 0.8; }
        .stat-value { font-family: 'Rajdhani', sans-serif; font-size: 2.2rem; font-weight: 700; color: var(--text-main); text-shadow: 0 0 10px var(--shadow-glow); }
        .stat-label { font-size: 0.8rem; color: var(--text-sub); text-transform: uppercase; letter-spacing: 1px; margin-top: 5px; }

        /* Scoring Breakdown */
        .criteria-box {
            margin-top: 20px;
            border-top: 1px dashed var(--border-glass);
            padding-top: 15px;
            font-size: 0.85rem;
            color: var(--text-sub);
        }
        .criteria-title { font-weight: bold; color: var(--c-primary); margin-bottom: 10px; display: block; cursor: pointer; }
        .criteria-content { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; 
            background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;
        }
        .crit-item { display: flex; justify-content: space-between; margin-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 4px; }
        .crit-rank { font-weight: bold; }
        .crit-s { color: #ffd700; } .crit-a { color: var(--c-primary); } .crit-b { color: var(--c-success); } .crit-c { color: var(--c-warning); }
        
        /* Upload */
        .upload-zone {
            padding: 40px; text-align: center; cursor: pointer; margin-bottom: 40px;
            border: 2px dashed var(--text-sub); opacity: 0.8;
            background: var(--bg-upload);
        }
        .upload-zone:hover { 
            background: var(--bg-table-head); border-color: var(--c-primary); opacity: 1;
        }

        /* Score & Summary */
        .eval-grid { display: grid; grid-template-columns: 350px 1fr; gap: 25px; margin-bottom: 35px; }
        .score-card { display: flex; flex-direction: column; padding: 25px; height: 100%; justify-content: flex-start; }
        
        .score-display-row {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin-bottom: 15px; flex-grow: 1;
        }

        .score-circle {
            width: 140px; height: 140px; border-radius: 50%;
            border: 4px solid rgba(128,128,128,0.1);
            border-top: 4px solid var(--c-primary); border-right: 4px solid var(--c-secondary);
            box-shadow: 0 0 15px var(--shadow-glow);
            display: flex; align-items: center; justify-content: center; flex-direction: column;
            margin-bottom: 15px; animation: spin-glow 8s linear infinite;
        }
        @keyframes spin-glow { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .score-content { position: absolute; display: flex; flex-direction: column; align-items: center; }
        .score-val { font-size: 3.5rem; font-weight: 700; color: var(--text-main); text-shadow: 0 0 10px var(--shadow-glow); line-height: 1; font-family: 'Rajdhani', sans-serif; }
        .score-lbl { font-size: 0.8rem; letter-spacing: 2px; color: var(--c-primary); margin-top: 5px; }
        
        .rank-badge {
            font-size: 1.5rem; font-weight: 800; padding: 5px 30px; color: var(--text-main);
            border: 1px solid var(--c-primary); border-radius: 4px; background: var(--bg-table-head);
            font-family: 'Rajdhani', sans-serif;
        }

        .summary-card { padding: 30px; display: flex; flex-direction: column; justify-content: center; }
        .summary-item { margin-bottom: 12px; display: flex; align-items: flex-start; line-height: 1.6; border-bottom: 1px solid var(--border-glass); padding-bottom: 8px; }
        .summary-item:last-child { border-bottom: none; }
        .summary-icon { margin-right: 12px; font-size: 1.2rem; filter: grayscale(0.2); }
        
        .txt-good { color: var(--c-success); } .txt-warn { color: var(--c-warning); } .txt-bad { color: var(--c-danger); } .txt-info { color: var(--c-primary); }

        /* Charts */
        .charts-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-bottom: 35px; }
        .full-width { grid-column: span 2; }
        .chart-box { padding: 20px; height: 380px; position: relative; }
        .chart-title { 
            position: absolute; top: 15px; left: 20px; z-index: 10; pointer-events: none;
            background: var(--bg-panel); padding: 4px 8px; border-radius: 4px; border: 1px solid var(--border-glass);
        }

        /* Table */
        .table-wrapper { overflow-x: auto; margin-top: 25px; }
        table { width: 100%; border-collapse: collapse; font-size: 0.95rem; white-space: nowrap; }
        th { 
            text-align: left; padding: 18px; color: var(--c-primary); 
            border-bottom: 1px solid var(--border-glass); background: var(--bg-table-head);
        }
        td { padding: 16px 18px; border-bottom: 1px solid var(--border-glass); color: var(--text-main); }
        tr:hover td { background: var(--bg-table-hover); }
        
        /* Summary Rows in Table */
        tr.row-sw td { background: var(--bg-sw-row); border-top: 2px solid var(--c-secondary); font-weight: bold; }
        tr.row-avg td { background: var(--bg-avg-row); border-top: 2px solid var(--c-primary); font-weight: bold; color: var(--c-primary); }

        .badge { padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 600; border: 1px solid transparent; }

        .hidden { display: none; }
        
        @media (max-width: 1000px) {
            .eval-grid, .charts-grid, .pro-stats-grid { grid-template-columns: 1fr; }
            .controls-bar { position: relative; justify-content: center; margin-bottom: 20px; right: auto; top: auto; flex-wrap: wrap; }
            .criteria-content { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body class="lang-zh"> 

<div class="container">
    <div class="controls-bar">
        <select class="ui-select" id="langSelect" onchange="setLanguage(this.value)">
            <option value="zh">ÁπÅÈ´î‰∏≠Êñá (TW)</option>
            <option value="en" selected>English (US)</option>
            <option value="jp">Êó•Êú¨Ë™û (JP)</option>
            <option value="de">Deutsch (DE)</option>
            <option value="fr">Fran√ßais (FR)</option>
            <option value="es">Espa√±ol (ES)</option>
            <option value="it">Italiano (IT)</option>
            <option value="pt">Portugu√™s (PT)</option>
            <option value="kr">ÌïúÍµ≠Ïñ¥ (KR)</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π (RU)</option>
        </select>
        <select class="ui-select" id="themeSelect" onchange="applyTheme(this.value)">
            <optgroup label="Dark Themes">
                <option value="dark_default" selected>üåå Deep Space</option>
                <option value="dark_onyx">üåë Cyber Onyx</option>
                <option value="dark_forest">üå≤ Midnight Forest</option>
                <option value="dark_amethyst">üîÆ Amethyst Void</option>
                <option value="dark_carbon">üèéÔ∏è Carbon Red</option>
            </optgroup>
            <optgroup label="Light Themes">
                <option value="light_polar">‚ùÑÔ∏è Polar White</option>
                <option value="light_ceramic">üè∫ Ceramic Gray</option>
                <option value="light_mint">üåø Mint Lab</option>
                <option value="light_lavender">üå∏ Lavender Mist</option>
                <option value="light_steel">üèôÔ∏è Steel Blue</option>
            </optgroup>
        </select>
    </div>

    <header>
        <div class="title-main">A1 EVO ACOUSTIX LOG ANALYZER</div>
        <div class="title-sub">OCA's ACOUSTIC CALIBRATION SYSTEM v20260125</div>
    </header>

    <div class="glass-panel upload-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
        <h3 class="txt-render" data-key="drop_title" style="color: var(--c-primary); margin-bottom: 5px; font-size: 1.5rem; letter-spacing: 1px;">INITIALIZE DATA STREAM</h3>
        <p class="txt-render" data-key="drop_sub" style="color: var(--text-sub); text-transform: uppercase; letter-spacing: 2px; font-size: 0.85rem;">Drag & Drop Log File</p>
        <p class="mono" style="font-size: 0.8rem; color: var(--text-sub); margin-top: 10px; opacity: 0.7;">SUPPORTED FORMAT: session_log_xxxx.txt</p>
        <input type="file" id="fileInput" accept=".txt" style="display: none">
    </div>

    <div id="dashboard" class="hidden">
        
        <div class="pro-stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üì∂</div>
                <div class="stat-value" id="val_avg_snr">-</div>
                <div class="stat-label txt-render" data-key="stat_snr">SYSTEM AVG SNR</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚è±Ô∏è</div>
                <div class="stat-value" id="val_sys_jitter">-</div>
                <div class="stat-label txt-render" data-key="stat_jitter">SYSTEM CLOCK JITTER</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-value" id="val_tot_impulse">-</div>
                <div class="stat-label txt-render" data-key="stat_impulse">TOTAL DELAY (ms)</div>
            </div>
             <div class="stat-card">
                <div class="stat-icon">üîä</div>
                <div class="stat-value" id="val_sw_count">-</div>
                <div class="stat-label txt-render" data-key="stat_sub">SUBWOOFERS ACTIVE</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üõ°Ô∏è</div>
                <div class="stat-value" id="val_tot_rej">-</div>
                <div class="stat-label txt-render" data-key="stat_rej">TOTAL REJECTIONS</div>
            </div>
        </div>

        <div class="glass-panel" style="padding: 25px;">
            <div style="margin-bottom: 20px;">
                <span class="txt-render" data-key="table_title" style="color: var(--c-primary); font-size: 1.2rem; font-weight: bold;">Ë©≥Á¥∞ÈáèÊ∏¨Êï∏ÊìöË°®</span>
            </div>
            <div class="table-wrapper">
                <table id="dataTable" class="mono">
                    <thead>
                        <tr>
                            <th><span class="txt-render" data-key="col_ch">ËÅ≤ÈÅì</span></th>
                            <th><span class="txt-render" data-key="col_status">ÁãÄÊÖã</span></th>
                            <th><span class="txt-render" data-key="col_acc">Êé•Âèó</span></th>
                            <th><span class="txt-render" data-key="col_rej">ÊéíÊñ•</span></th>
                            <th><span class="txt-render" data-key="col_base_snr">ÂàùÂßã SNR</span></th>
                            <th><span class="txt-render" data-key="col_final_snr">ÊúÄÁµÇ SNR</span></th>
                            <th><span class="txt-render" data-key="col_gain">Â¢ûÁõä</span></th>
                            <th><span class="txt-render" data-key="col_peak_jit">Â≥∞ÂÄºÊäñÂãï</span></th>
                            <th><span class="txt-render" data-key="col_peak_freq">Â≥∞ÂÄºÈ†ªÁéá</span></th>
                            <th><span class="txt-render" data-key="col_avg_jit">Âπ≥ÂùáÊäñÂãï</span></th>
                            <th><span class="txt-render" data-key="col_polarity">Ê•µÊÄß</span></th>
                            <th><span class="txt-render" data-key="col_impulse">ËÑàË°ùÊôÇÈñì</span></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div class="eval-grid">
            <div class="glass-panel score-card">
                <div class="score-display-row">
                    <div style="position: relative; display: flex; justify-content: center; align-items: center;">
                        <div class="score-circle"></div>
                        <div class="score-content">
                            <span class="score-val" id="scoreValue">0</span>
                            <span class="score-lbl">SCORE</span>
                        </div>
                    </div>
                    <div class="rank-badge" id="rankBadge">-</div>
                </div>

                <div class="criteria-box">
                    <div class="criteria-title txt-render" data-key="crit_title" onclick="this.nextElementSibling.classList.toggle('hidden')">
                        ‚ñº Êü•ÁúãË©ïÂàÜÊ®ôÊ∫ñ (SCORING LOGIC)
                    </div>
                    <div class="criteria-content hidden">
                        <div class="mono" style="grid-column: span 2; margin-bottom: 10px; color: var(--c-primary);">BASE SCORE: 100 POINTS</div>
                        
                        <div>
                            <div class="crit-item"><span>SNR &lt; 52dB</span> <span class="txt-bad">-2 / dB</span></div>
                            <div class="crit-item"><span>Jitter &gt; 30us</span> <span class="txt-bad">-0.5 / us</span></div>
                            <div class="crit-item"><span>Rejection</span> <span class="txt-bad">-1 / event</span></div>
                        </div>

                        <div>
                            <div class="crit-item"><span class="crit-rank crit-s">S CLASS</span> <span>95 - 100</span></div>
                            <div class="crit-item"><span class="crit-rank crit-a">A CLASS</span> <span>85 - 94</span></div>
                            <div class="crit-item"><span class="crit-rank crit-b">B CLASS</span> <span>75 - 84</span></div>
                            <div class="crit-item"><span class="crit-rank crit-c">C CLASS</span> <span>&lt; 75</span></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="glass-panel summary-card">
                <div style="margin-bottom: 20px; border-bottom: 1px solid var(--border-glass); padding-bottom: 10px;">
                    <span class="txt-render" data-key="summary_title" style="color: var(--c-primary); font-size: 1.1rem; font-weight: bold;">Á≥ªÁµ±Ë®∫Êñ∑ÊëòË¶Å</span>
                </div>
                <div id="summaryText" style="color: var(--text-main);">Analyzing...</div>
            </div>
        </div>

        <div class="charts-grid">
            <div class="glass-panel chart-box">
                <div class="chart-title txt-render" data-key="chart_accept">Ê∏¨ÈáèÁãÄÊÖãÂàÜ‰Ωà</div>
                <canvas id="chartAccept"></canvas>
            </div>
            <div class="glass-panel chart-box">
                <div class="chart-title txt-render" data-key="chart_snr">Ë®äËôüÂô™Ë®äÊØîÊîπÂñÑ</div>
                <canvas id="chartSNR"></canvas>
            </div>
        </div>

        <div class="charts-grid">
            <div class="glass-panel chart-box">
                <div class="chart-title txt-render" data-key="chart_avg_jitter">Âπ≥ÂùáÊôÇÂü∫Ë™§Â∑Æ</div>
                <canvas id="chartAvgJitter"></canvas>
            </div>
            <div class="glass-panel chart-box">
                <div class="chart-title txt-render" data-key="chart_peak_jitter">Â≥∞ÂÄºÊäñÂãïËàáÈ†ªÁéá</div>
                <canvas id="chartPeakJitter"></canvas>
            </div>
        </div>

        <div class="charts-grid">
            <div class="glass-panel chart-box full-width">
                <div class="chart-title txt-render" data-key="chart_impulse">ËÑàË°ùÂ≥∞ÂÄºÊôÇÈñì</div>
                <canvas id="chartImpulse"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
    // --- Multilingual Channel Dictionary (Expanded v3.4) ---
    const channelNames = {
        "FL": { en: "Front Left", zh: "Â∑¶ÂâçÁΩÆ", jp: "„Éï„É≠„É≥„ÉàÂ∑¶", de: "Vorne Links", fr: "Avant Gauche", es: "Frontal Izq", it: "Anteriore Sx", pt: "Frontal Esq", kr: "Ï†ÑÎ©¥ Ï¢åÏ∏°", ru: "–§—Ä–æ–Ω—Ç. –ª–µ–≤—ã–π" },
        "FR": { en: "Front Right", zh: "Âè≥ÂâçÁΩÆ", jp: "„Éï„É≠„É≥„ÉàÂè≥", de: "Vorne Rechts", fr: "Avant Droit", es: "Frontal Der", it: "Anteriore Dx", pt: "Frontal Dir", kr: "Ï†ÑÎ©¥ Ïö∞Ï∏°", ru: "–§—Ä–æ–Ω—Ç. –ø—Ä–∞–≤—ã–π" },
        "C": { en: "Center", zh: "‰∏≠ÁΩÆ", jp: "„Çª„É≥„Çø„Éº", de: "Center", fr: "Centre", es: "Central", it: "Centrale", pt: "Central", kr: "ÏÑºÌÑ∞", ru: "–¶–µ–Ω—Ç—Ä" },
        "SW": { en: "Subwoofer", zh: "Ë∂Ö‰ΩéÈü≥", jp: "„Çµ„Éñ„Ç¶„Éº„Éï„Ç°„Éº", de: "Subwoofer", fr: "Caisson", es: "Subwoofer", it: "Subwoofer", pt: "Subwoofer", kr: "ÏÑúÎ∏åÏö∞Ìçº", ru: "–°–∞–±–≤—É—Ñ–µ—Ä" },
        "SLA": { en: "Surround Left", zh: "Â∑¶ÂÅ¥Áí∞Áπû", jp: "„Çµ„É©„Ç¶„É≥„ÉâÂ∑¶", de: "Surround Links", fr: "Surround Gauche", es: "Surround Izq", it: "Surround Sx", pt: "Surround Esq", kr: "ÏÑúÎùºÏö¥Îìú Ï¢åÏ∏°", ru: "–°—É—Ä—Ä–∞—É–Ω–¥ –ª–µ–≤—ã–π" },
        "SRA": { en: "Surround Right", zh: "Âè≥ÂÅ¥Áí∞Áπû", jp: "„Çµ„É©„Ç¶„É≥„ÉâÂè≥", de: "Surround Rechts", fr: "Surround Droit", es: "Surround Der", it: "Surround Dx", pt: "Surround Dir", kr: "ÏÑúÎùºÏö¥Îìú Ïö∞Ï∏°", ru: "–°—É—Ä—Ä–∞—É–Ω–¥ –ø—Ä–∞–≤—ã–π" },
        "SBL": { en: "Surr. Back Left", zh: "Â∑¶ÂæåÁí∞Áπû", jp: "„Çµ„É©„Ç¶„É≥„Éâ„Éê„ÉÉ„ÇØÂ∑¶", de: "Surr. Back Links", fr: "Arr. Surround G", es: "Surr. Trasero Izq", it: "Surr. Post. Sx", pt: "Surr. Tras. Esq", kr: "ÌõÑÎ©¥ ÏÑúÎùºÏö¥Îìú Ï¢å", ru: "–¢—ã–ª–æ–≤–æ–π –ª–µ–≤—ã–π" },
        "SBR": { en: "Surr. Back Right", zh: "Âè≥ÂæåÁí∞Áπû", jp: "„Çµ„É©„Ç¶„É≥„Éâ„Éê„ÉÉ„ÇØÂè≥", de: "Surr. Back Rechts", fr: "Arr. Surround D", es: "Surr. Trasero Der", it: "Surr. Post. Dx", pt: "Surr. Tras. Dir", kr: "ÌõÑÎ©¥ ÏÑúÎùºÏö¥Îìú Ïö∞", ru: "–¢—ã–ª–æ–≤–æ–π –ø—Ä–∞–≤—ã–π" },
        
        // Expanded Channels
        "FWL": { en: "Front Wide Left", zh: "Â∑¶ÂâçÂØ¨", jp: "„Éï„É≠„É≥„Éà„ÉØ„Ç§„ÉâÂ∑¶", de: "Front Wide Links", fr: "Avant Large G", es: "Ancho Frontal Izq", it: "Wide Ant. Sx", pt: "Frontal Amplo Esq", kr: "Ï†ÑÎ©¥ ÏôÄÏù¥Îìú Ï¢å", ru: "–®–∏—Ä–æ–∫–∏–π —Ñ—Ä–æ–Ω—Ç. –õ" },
        "FWR": { en: "Front Wide Right", zh: "Âè≥ÂâçÂØ¨", jp: "„Éï„É≠„É≥„Éà„ÉØ„Ç§„ÉâÂè≥", de: "Front Wide Rechts", fr: "Avant Large D", es: "Ancho Frontal Der", it: "Wide Ant. Dx", pt: "Frontal Amplo Dir", kr: "Ï†ÑÎ©¥ ÏôÄÏù¥Îìú Ïö∞", ru: "–®–∏—Ä–æ–∫–∏–π —Ñ—Ä–æ–Ω—Ç. –ü" },
        "FHL": { en: "Front Height L", zh: "Â∑¶ÂâçÂ§©Á©∫", jp: "„Éï„É≠„É≥„Éà„Éè„Ç§„ÉàÂ∑¶", de: "Front Height L", fr: "Hauteur Avant G", es: "Altura Frontal Izq", it: "Altezza Ant. Sx", pt: "Altura Front. Esq", kr: "Ï†ÑÎ©¥ ÎÜíÏù¥ Ï¢å", ru: "–í–µ—Ä—Ö–Ω–∏–π –ø–µ—Ä–µ–¥. –õ" },
        "FHR": { en: "Front Height R", zh: "Âè≥ÂâçÂ§©Á©∫", jp: "„Éï„É≠„É≥„Éà„Éè„Ç§„ÉàÂè≥", de: "Front Height R", fr: "Hauteur Avant D", es: "Altura Frontal Der", it: "Altezza Ant. Dx", pt: "Altura Front. Dir", kr: "Ï†ÑÎ©¥ ÎÜíÏù¥ Ïö∞", ru: "–í–µ—Ä—Ö–Ω–∏–π –ø–µ—Ä–µ–¥. –ü" },
        "TML": { en: "Top Middle Left", zh: "Â∑¶‰∏≠Â§©Á©∫", jp: "„Éà„ÉÉ„Éó„Éü„Éâ„É´Â∑¶", de: "Top Middle Links", fr: "Top Milieu G", es: "Techo Medio Izq", it: "Top Medio Sx", pt: "Teto M√©dio Esq", kr: "ÏÉÅÎã® Ï§ëÍ∞Ñ Ï¢å", ru: "–í–µ—Ä—Ö–Ω–∏–π —Å—Ä–µ–¥–Ω–∏–π –õ" },
        "TMR": { en: "Top Middle Right", zh: "Âè≥‰∏≠Â§©Á©∫", jp: "„Éà„ÉÉ„Éó„Éü„Éâ„É´Âè≥", de: "Top Middle Rechts", fr: "Top Milieu D", es: "Techo Medio Der", it: "Top Medio Dx", pt: "Teto M√©dio Dir", kr: "ÏÉÅÎã® Ï§ëÍ∞Ñ Ïö∞", ru: "–í–µ—Ä—Ö–Ω–∏–π —Å—Ä–µ–¥–Ω–∏–π –ü" },
        "TRL": { en: "Top Rear Left", zh: "Â∑¶ÂæåÂ§©Á©∫", jp: "„Éà„ÉÉ„Éó„É™„Ç¢Â∑¶", de: "Top Rear Links", fr: "Top Arri√®re G", es: "Techo Trasero Izq", it: "Top Post. Sx", pt: "Teto Tras. Esq", kr: "ÏÉÅÎã® ÌõÑÎ©¥ Ï¢å", ru: "–í–µ—Ä—Ö–Ω–∏–π –∑–∞–¥–Ω–∏–π –õ" },
        "TRR": { en: "Top Rear Right", zh: "Âè≥ÂæåÂ§©Á©∫", jp: "„Éà„ÉÉ„Éó„É™„Ç¢Âè≥", de: "Top Rear Rechts", fr: "Top Arri√®re D", es: "Techo Trasero Der", it: "Top Post. Dx", pt: "Teto Tras. Dir", kr: "ÏÉÅÎã® ÌõÑÎ©¥ Ïö∞", ru: "–í–µ—Ä—Ö–Ω–∏–π –∑–∞–¥–Ω–∏–π –ü" },
        "RHL": { en: "Rear Height Left", zh: "Â∑¶ÂæåÂ¢ûÈ´ò", jp: "„É™„Ç¢„Éè„Ç§„ÉàÂ∑¶", de: "Rear Height Links", fr: "Hauteur Arri√®re G", es: "Altura Trasera Izq", it: "Altezza Post. Sx", pt: "Altura Tras. Esq", kr: "ÌõÑÎ©¥ ÎÜíÏù¥ Ï¢å", ru: "–ó–∞–¥–Ω–∏–π –≤–µ—Ä—Ö–Ω–∏–π –õ" },
        "RHR": { en: "Rear Height Right", zh: "Âè≥ÂæåÂ¢ûÈ´ò", jp: "„É™„Ç¢„Éè„Ç§„ÉàÂè≥", de: "Rear Height Rechts", fr: "Hauteur Arri√®re D", es: "Altura Trasera Der", it: "Altezza Post. Dx", pt: "Altura Tras. Dir", kr: "ÌõÑÎ©¥ ÎÜíÏù¥ Ïö∞", ru: "–ó–∞–¥–Ω–∏–π –≤–µ—Ä—Ö–Ω–∏–π –ü" },
        "TFL": { en: "Top Front Left", zh: "Â∑¶‰∏äÂ§©Á©∫", jp: "„Éà„ÉÉ„Éó„Éï„É≠„É≥„ÉàÂ∑¶", de: "Top Front Links", fr: "Top Avant G", es: "Techo Frontal Izq", it: "Top Ant. Sx", pt: "Teto Front. Esq", kr: "ÏÉÅÎã® Ï†ÑÎ©¥ Ï¢å", ru: "–í–µ—Ä—Ö–Ω–∏–π –ø–µ—Ä–µ–¥. –õ" },
        "TFR": { en: "Top Front Right", zh: "Âè≥‰∏äÂ§©Á©∫", jp: "„Éà„ÉÉ„Éó„Éï„É≠„É≥„ÉàÂè≥", de: "Top Front Rechts", fr: "Top Avant D", es: "Techo Frontal Der", it: "Top Ant. Dx", pt: "Teto Front. Dir", kr: "ÏÉÅÎã® Ï†ÑÎ©¥ Ïö∞", ru: "–í–µ—Ä—Ö–Ω–∏–π –ø–µ—Ä–µ–¥. –ü" },
        "TS": { en: "Top Surround", zh: "È†ÇÂ±§Áí∞Áπû", jp: "„Éà„ÉÉ„Éó„Çµ„É©„Ç¶„É≥„Éâ", de: "Top Surround", fr: "Top Surround", es: "Surround Techo", it: "Top Surround", pt: "Surround Teto", kr: "ÌÉë ÏÑúÎùºÏö¥Îìú", ru: "–ü–æ—Ç–æ–ª–æ—á–Ω—ã–π —Å—É—Ä—Ä–∞—É–Ω–¥" },
        "CH": { en: "Center Height", zh: "‰∏≠ÁΩÆÂ¢ûÈ´ò", jp: "„Çª„É≥„Çø„Éº„Éè„Ç§„Éà", de: "Center Height", fr: "Hauteur Centre", es: "Altura Central", it: "Altezza Centrale", pt: "Altura Central", kr: "ÏÑºÌÑ∞ ÎÜíÏù¥", ru: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≤–µ—Ä—Ö–Ω–∏–π" }
    };

    const dict = {
        en: {
            drop_title: "INITIALIZE DATA STREAM", drop_sub: "Drag & Drop Log File",
            stat_snr: "SYSTEM AVG SNR", stat_jitter: "SYS CLOCK JITTER", stat_impulse: "TOTAL DELAY (ms)", stat_sub: "ACTIVE SUBWOOFERS", stat_rej: "TOTAL REJECTIONS",
            crit_title: "‚ñº VIEW SCORING LOGIC",
            summary_title: "System Diagnostic Summary",
            chart_accept: "Measurement Acceptance", chart_snr: "SNR Improvement (Base vs Final)",
            chart_avg_jitter: "Average Jitter (System Stability)", chart_peak_jitter: "Peak Jitter & Frequency Analysis",
            chart_impulse: "Impulse Peak Time (Time Alignment)",
            table_title: "Detailed Telemetry Data Table",
            col_ch: "CH", col_status: "Status", col_acc: "Acc.", col_rej: "Rej.",
            col_base_snr: "Base SNR", col_final_snr: "Final SNR", col_gain: "Gain",
            col_peak_jit: "Pk Jitter", col_peak_freq: "Pk Freq", col_avg_jit: "Avg Jitter",
            col_polarity: "Polarity", col_impulse: "Impulse",
            row_sw: "SW (SUB) SUMMARY", row_avg: "SYSTEM AVERAGE",
            sum_good_snr: "Excellent Signal Quality", sum_ok_snr: "Good Signal Quality", sum_bad_snr: "High Noise Floor Detected",
            sum_good_jit: "Rock Solid Clocking", sum_warn_jit: "Jitter slightly elevated",
            sum_good_rej: "Perfect Data Integrity", sum_bad_rej: "measurements rejected",
            perfect: "PERFECT", warn: "WARN", normal: "Normal", inverted: "Inverted"
        },
        zh: {
            drop_title: "ÂïüÂãïÊï∏Êìö‰∏≤ÊµÅÂàÜÊûê", drop_sub: "ÊãñÊîæ Log Ê™îÊ°àËá≥Ê≠§",
            stat_snr: "Á≥ªÁµ±Âπ≥ÂùáÂô™Ë®äÊØî", stat_jitter: "Á≥ªÁµ±Âπ≥ÂùáÊôÇÂü∫Ë™§Â∑Æ", stat_impulse: "ËÑàË°ùÂª∂ÈÅ≤Á∏ΩÂíå", stat_sub: "Ë∂Ö‰ΩéÈü≥Êï∏Èáè", stat_rej: "Á∏ΩÊéíÊñ•Ê¨°Êï∏",
            crit_title: "‚ñº Êü•ÁúãË©ïÂàÜÊ®ôÊ∫ñÈÇèËºØ",
            summary_title: "Á≥ªÁµ±Ë®∫Êñ∑ÊëòË¶Å",
            chart_accept: "Ê∏¨ÈáèÁãÄÊÖãÂàÜ‰Ωà", chart_snr: "Ë®äËôüÂô™Ë®äÊØîÊîπÂñÑ",
            chart_avg_jitter: "Âπ≥ÂùáÊôÇÂü∫Ë™§Â∑Æ", chart_peak_jitter: "Â≥∞ÂÄºÊäñÂãïËàáÈ†ªÁéá",
            chart_impulse: "ËÑàË°ùÂ≥∞ÂÄºÊôÇÈñì",
            table_title: "Ë©≥Á¥∞ÈÅôÊ∏¨Êï∏ÊìöË°®",
            col_ch: "ËÅ≤ÈÅì", col_status: "ÁãÄÊÖã", col_acc: "Êé•Âèó", col_rej: "ÊéíÊñ•",
            col_base_snr: "ÂàùÂßã SNR", col_final_snr: "ÊúÄÁµÇ SNR", col_gain: "Â¢ûÁõä",
            col_peak_jit: "Â≥∞ÂÄºÊäñÂãï", col_peak_freq: "Â≥∞ÂÄºÈ†ªÁéá", col_avg_jit: "Âπ≥ÂùáÊäñÂãï",
            col_polarity: "Ê•µÊÄßÊé®‰º∞", col_impulse: "ËÑàË°ùÊôÇÈñì",
            row_sw: "Èáç‰ΩéÈü≥(SW) ÂΩôÊï¥", row_avg: "ÂÖ®Á≥ªÁµ±Âπ≥Âùá",
            sum_good_snr: "Ë®äËôüÂìÅË≥™ÂÑ™Áï∞", sum_ok_snr: "Ë®äËôüÂìÅË≥™ËâØÂ•Ω", sum_bad_snr: "Â∫ïÂô™ÂÅèÈ´ò",
            sum_good_jit: "ÊôÇÈêòÊ•µÂ∫¶Á©©ÂÆö", sum_warn_jit: "ÊôÇÂü∫Ë™§Â∑ÆÊ≥®ÊÑè",
            sum_good_rej: "ÂÆåÁæéÊ∏¨Èáè", sum_bad_rej: "Ê¨°Ê∏¨ÈáèÂõ†Âπ≤ÊìæË¢´Êãí",
            perfect: "ÂÆåÁæé", warn: "Ë≠¶Âëä", normal: "Ê≠£Áõ∏", inverted: "ÂèçÁõ∏"
        },
        jp: {
            drop_title: "„Éá„Éº„Çø„Çπ„Éà„É™„Éº„É†ÂàùÊúüÂåñ", drop_sub: "„É≠„Ç∞„Éï„Ç°„Ç§„É´„Çí„Éâ„É≠„ÉÉ„Éó",
            stat_snr: "„Ç∑„Çπ„ÉÜ„É†Âπ≥Âùá SNR", stat_jitter: "„Ç∑„Çπ„ÉÜ„É†„ÇØ„É≠„ÉÉ„ÇØ„Ç∏„ÉÉ„Çø„Éº", stat_impulse: "ÂêàË®àÈÅÖÂª∂ÊôÇÈñì (ms)", stat_sub: "„Çµ„Éñ„Ç¶„Éº„Éï„Ç°„ÉºÊï∞", stat_rej: "Á∑èÊãíÂê¶ÂõûÊï∞",
            crit_title: "‚ñº „Çπ„Ç≥„Ç¢„É™„É≥„Ç∞Âü∫Ê∫ñ„ÇíË°®Á§∫",
            summary_title: "„Ç∑„Çπ„ÉÜ„É†Ë®∫Êñ≠„Çµ„Éû„É™„Éº",
            chart_accept: "Ê∏¨ÂÆö„Çπ„ÉÜ„Éº„Çø„ÇπÂàÜÂ∏É", chart_snr: "SNRÊîπÂñÑÁéá",
            chart_avg_jitter: "Âπ≥Âùá„Ç∏„ÉÉ„Çø„Éº (ÂÆâÂÆöÊÄß)", chart_peak_jitter: "„Éî„Éº„ÇØ„Ç∏„ÉÉ„Çø„Éº„Å®Âë®Ê≥¢Êï∞",
            chart_impulse: "„Ç§„É≥„Éë„É´„Çπ„Éî„Éº„ÇØÊôÇÈñì",
            table_title: "Ë©≥Á¥∞„ÉÜ„É¨„É°„Éà„É™„Éá„Éº„Çø",
            col_ch: "Ch", col_status: "Áä∂ÊÖã", col_acc: "ÂèóÁêÜ", col_rej: "ÊãíÂê¶",
            col_base_snr: "ÂàùÊúü SNR", col_final_snr: "ÊúÄÁµÇ SNR", col_gain: "„Ç≤„Ç§„É≥",
            col_peak_jit: "Pk Jitter", col_peak_freq: "Pk Freq", col_avg_jit: "Avg Jitter",
            col_polarity: "Ê•µÊÄß", col_impulse: "„Ç§„É≥„Éë„É´„Çπ",
            row_sw: "„Çµ„Éñ„Ç¶„Éº„Éï„Ç°„ÉºÈõÜË®à", row_avg: "„Ç∑„Çπ„ÉÜ„É†Âπ≥Âùá",
            sum_good_snr: "‰ø°Âè∑ÂìÅË≥™„ÅØÂÑ™„Çå„Å¶„ÅÑ„Åæ„Åô", sum_ok_snr: "‰ø°Âè∑ÂìÅË≥™„ÅØËâØÂ•Ω„Åß„Åô", sum_bad_snr: "„Éé„Ç§„Ç∫„Éï„É≠„Ç¢„ÅåÈ´ò„ÅÑ",
            sum_good_jit: "„ÇØ„É≠„ÉÉ„ÇØ„ÅØÈùûÂ∏∏„Å´ÂÆâÂÆö", sum_warn_jit: "„Ç∏„ÉÉ„Çø„Éº„Å´Ê≥®ÊÑè",
            sum_good_rej: "ÂÆåÁíß„Å™Ê∏¨ÂÆö", sum_bad_rej: "Âõû„ÅÆÊ∏¨ÂÆö„ÅåÊãíÂê¶„Åï„Çå„Åæ„Åó„Åü",
            perfect: "ÂÆåÁíß", warn: "Ë≠¶Âëä", normal: "Ê≠£Áõ∏", inverted: "ÈÄÜÁõ∏"
        },
        de: {
            drop_title: "DATENSTROM INITIALISIEREN", drop_sub: "Log-Datei hier ablegen",
            stat_snr: "SYSTEM-√ò SNR", stat_jitter: "SYSTEM-CLOCK-JITTER", stat_impulse: "GESAMTVERZ√ñGERUNG", stat_sub: "AKTIVE SUBWOOFER", stat_rej: "GESAMTABLEHNUNGEN",
            crit_title: "‚ñº BEWERTUNGSLOGIK ANZEIGEN",
            summary_title: "Diagnose-Zusammenfassung",
            chart_accept: "Messakzeptanz", chart_snr: "SNR-Verbesserung",
            chart_avg_jitter: "Durchschnittlicher Jitter", chart_peak_jitter: "Peak-Jitter & Frequenz",
            chart_impulse: "Impuls-Spitzenzeit",
            table_title: "Detaillierte Telemetriedaten",
            col_ch: "Kanal", col_status: "Status", col_acc: "Akz.", col_rej: "Abg.",
            col_base_snr: "Basis-SNR", col_final_snr: "Final-SNR", col_gain: "Verst.",
            col_peak_jit: "Peak-Jitter", col_peak_freq: "Peak-Freq", col_avg_jit: "√ò Jitter",
            col_polarity: "Polarit√§t", col_impulse: "Impuls",
            row_sw: "SUBWOOFER-ZUSAMMENFASSUNG", row_avg: "SYSTEMDURCHSCHNITT",
            sum_good_snr: "Exzellente Signalqualit√§t", sum_ok_snr: "Gute Signalqualit√§t", sum_bad_snr: "Hohes Grundrauschen",
            sum_good_jit: "Sehr stabiler Takt", sum_warn_jit: "Jitter leicht erh√∂ht",
            sum_good_rej: "Perfekte Datenintegrit√§t", sum_bad_rej: "Messungen abgelehnt",
            perfect: "PERFEKT", warn: "WARNUNG", normal: "Normal", inverted: "Invertiert"
        },
        fr: {
            drop_title: "INITIALISER LE FLUX", drop_sub: "D√©posez le fichier Log",
            stat_snr: "SNR MOYEN SYST√àME", stat_jitter: "JITTER SYST√àME", stat_impulse: "RETARD TOTAL (ms)", stat_sub: "SUBWOOFERS ACTIFS", stat_rej: "REJETS TOTAUX",
            crit_title: "‚ñº VOIR LA LOGIQUE DE NOTATION",
            summary_title: "R√©sum√© du diagnostic",
            chart_accept: "Acceptation des mesures", chart_snr: "Am√©lioration SNR",
            chart_avg_jitter: "Jitter moyen", chart_peak_jitter: "Pic de Jitter & Fr√©quence",
            chart_impulse: "Temps d'impulsion",
            table_title: "Donn√©es t√©l√©m√©triques d√©taill√©es",
            col_ch: "Canal", col_status: "√âtat", col_acc: "Acc.", col_rej: "Rej.",
            col_base_snr: "SNR Base", col_final_snr: "SNR Final", col_gain: "Gain",
            col_peak_jit: "Pic Jitter", col_peak_freq: "Pic Fr√©q", col_avg_jit: "Moy Jitter",
            col_polarity: "Polarit√©", col_impulse: "Impulsion",
            row_sw: "R√âSUM√â SUBWOOFER", row_avg: "MOYENNE SYST√àME",
            sum_good_snr: "Excellente qualit√© de signal", sum_ok_snr: "Bonne qualit√© de signal", sum_bad_snr: "Bruit de fond √©lev√©",
            sum_good_jit: "Horloge tr√®s stable", sum_warn_jit: "Jitter l√©g√®rement √©lev√©",
            sum_good_rej: "Int√©grit√© parfaite", sum_bad_rej: "mesures rejet√©es",
            perfect: "PARFAIT", warn: "ATTENTION", normal: "Normal", inverted: "Invers√©"
        },
        es: {
            drop_title: "INICIALIZAR DATOS", drop_sub: "Arrastre el archivo de registro",
            stat_snr: "SNR PROMEDIO", stat_jitter: "JITTER DE RELOJ", stat_impulse: "RETARDO TOTAL", stat_sub: "SUBWOOFERS ACTIVOS", stat_rej: "RECHAZOS TOTALES",
            crit_title: "‚ñº VER L√ìGICA DE PUNTUACI√ìN",
            summary_title: "Resumen de diagn√≥stico",
            chart_accept: "Aceptaci√≥n de medidas", chart_snr: "Mejora de SNR",
            chart_avg_jitter: "Jitter medio", chart_peak_jitter: "Pico de Jitter y Frecuencia",
            chart_impulse: "Tiempo de impulso",
            table_title: "Datos de telemetr√≠a detallados",
            col_ch: "Canal", col_status: "Estado", col_acc: "Acep.", col_rej: "Rech.",
            col_base_snr: "SNR Base", col_final_snr: "SNR Final", col_gain: "Ganancia",
            col_peak_jit: "Pico Jitter", col_peak_freq: "Pico Frec", col_avg_jit: "Jitter Med",
            col_polarity: "Polaridad", col_impulse: "Impulso",
            row_sw: "RESUMEN SUBWOOFER", row_avg: "PROMEDIO SISTEMA",
            sum_good_snr: "Excelente calidad de se√±al", sum_ok_snr: "Buena calidad de se√±al", sum_bad_snr: "Ruido de fondo alto",
            sum_good_jit: "Reloj muy estable", sum_warn_jit: "Jitter ligeramente elevado",
            sum_good_rej: "Integridad perfecta", sum_bad_rej: "medidas rechazadas",
            perfect: "PERFECTO", warn: "AVISO", normal: "Normal", inverted: "Invertido"
        },
        it: {
            drop_title: "INIZIALIZZA DATI", drop_sub: "Trascina il file di registro",
            stat_snr: "SNR MEDIA SISTEMA", stat_jitter: "JITTER SISTEMA", stat_impulse: "RITARDO TOTALE", stat_sub: "SUBWOOFER ATTIVI", stat_rej: "RIFIUTI TOTALI",
            crit_title: "‚ñº VEDI LOGICA PUNTEGGIO",
            summary_title: "Riepilogo diagnostico",
            chart_accept: "Accettazione misurazioni", chart_snr: "Miglioramento SNR",
            chart_avg_jitter: "Jitter medio", chart_peak_jitter: "Picco Jitter & Frequenza",
            chart_impulse: "Tempo di impulso",
            table_title: "Dati telemetrici dettagliati",
            col_ch: "Canale", col_status: "Stato", col_acc: "Acc.", col_rej: "Rif.",
            col_base_snr: "SNR Base", col_final_snr: "SNR Finale", col_gain: "Guadagno",
            col_peak_jit: "Picco Jitter", col_peak_freq: "Picco Freq", col_avg_jit: "Jitter Med",
            col_polarity: "Polarit√†", col_impulse: "Impulso",
            row_sw: "RIEPILOGO SUBWOOFER", row_avg: "MEDIA SISTEMA",
            sum_good_snr: "Eccellente qualit√† segnale", sum_ok_snr: "Buona qualit√† segnale", sum_bad_snr: "Rumore di fondo alto",
            sum_good_jit: "Clock molto stabile", sum_warn_jit: "Jitter leggermente alto",
            sum_good_rej: "Integrit√† perfetta", sum_bad_rej: "misurazioni rifiutate",
            perfect: "PERFETTO", warn: "ATTENZIONE", normal: "Normale", inverted: "Invertita"
        },
        pt: {
            drop_title: "INICIALIZAR DADOS", drop_sub: "Arraste o arquivo de log",
            stat_snr: "SNR M√âDIO DO SISTEMA", stat_jitter: "JITTER DO SISTEMA", stat_impulse: "ATRASO TOTAL", stat_sub: "SUBWOOFERS ATIVOS", stat_rej: "REJEI√á√ïES TOTAIS",
            crit_title: "‚ñº VER L√ìGICA DE PONTUA√á√ÉO",
            summary_title: "Resumo do Diagn√≥stico",
            chart_accept: "Aceita√ß√£o de Medi√ß√£o", chart_snr: "Melhoria SNR",
            chart_avg_jitter: "Jitter M√©dio", chart_peak_jitter: "Pico de Jitter & Freq.",
            chart_impulse: "Tempo de Impulso",
            table_title: "Dados de Telemetria Detalhados",
            col_ch: "Canal", col_status: "Estado", col_acc: "Ace.", col_rej: "Rej.",
            col_base_snr: "SNR Base", col_final_snr: "SNR Final", col_gain: "Ganho",
            col_peak_jit: "Pico Jitter", col_peak_freq: "Pico Freq", col_avg_jit: "Jitter M√©d",
            col_polarity: "Polaridade", col_impulse: "Impulso",
            row_sw: "RESUMO SUBWOOFER", row_avg: "M√âDIA DO SISTEMA",
            sum_good_snr: "Excelente qualidade de sinal", sum_ok_snr: "Boa qualidade de sinal", sum_bad_snr: "Ru√≠do de fundo alto",
            sum_good_jit: "Clock muito est√°vel", sum_warn_jit: "Jitter levemente alto",
            sum_good_rej: "Integridade perfeita", sum_bad_rej: "medi√ß√µes rejeitadas",
            perfect: "PERFEITO", warn: "AVISO", normal: "Normal", inverted: "Invertida"
        },
        kr: {
            drop_title: "Îç∞Ïù¥ÌÑ∞ Ïä§Ìä∏Î¶º Ï¥àÍ∏∞Ìôî", drop_sub: "Î°úÍ∑∏ ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÏÑ∏Ïöî",
            stat_snr: "ÏãúÏä§ÌÖú ÌèâÍ∑† SNR", stat_jitter: "ÏãúÏä§ÌÖú ÌÅ¥Îü≠ ÏßÄÌÑ∞", stat_impulse: "Ï¥ù ÏßÄÏó∞ ÏãúÍ∞Ñ", stat_sub: "ÌôúÏÑ± ÏÑúÎ∏åÏö∞Ìçº", stat_rej: "Ï¥ù Í±∞Î∂Ä ÌöüÏàò",
            crit_title: "‚ñº Ï±ÑÏ†ê Í∏∞Ï§Ä Î≥¥Í∏∞",
            summary_title: "ÏãúÏä§ÌÖú ÏßÑÎã® ÏöîÏïΩ",
            chart_accept: "Ï∏°Ï†ï ÏàòÎùΩ ÏÉÅÌÉú", chart_snr: "SNR Í∞úÏÑ† (Í∏∞Î≥∏ vs ÏµúÏ¢Ö)",
            chart_avg_jitter: "ÌèâÍ∑† ÏßÄÌÑ∞ (ÏãúÏä§ÌÖú ÏïàÏ†ïÏÑ±)", chart_peak_jitter: "ÌîºÌÅ¨ ÏßÄÌÑ∞ Î∞è Ï£ºÌååÏàò",
            chart_impulse: "ÏûÑÌéÑÏä§ ÌîºÌÅ¨ ÏãúÍ∞Ñ",
            table_title: "ÏÉÅÏÑ∏ ÏõêÍ≤© Ï∏°Ï†ï Îç∞Ïù¥ÌÑ∞",
            col_ch: "Ï±ÑÎÑê", col_status: "ÏÉÅÌÉú", col_acc: "ÏàòÎùΩ", col_rej: "Í±∞Î∂Ä",
            col_base_snr: "Í∏∞Î≥∏ SNR", col_final_snr: "ÏµúÏ¢Ö SNR", col_gain: "Ïù¥Îìù",
            col_peak_jit: "ÌîºÌÅ¨ ÏßÄÌÑ∞", col_peak_freq: "ÌîºÌÅ¨ Ï£ºÌååÏàò", col_avg_jit: "ÌèâÍ∑† ÏßÄÌÑ∞",
            col_polarity: "Í∑πÏÑ±", col_impulse: "ÏûÑÌéÑÏä§",
            row_sw: "ÏÑúÎ∏åÏö∞Ìçº ÏöîÏïΩ", row_avg: "ÏãúÏä§ÌÖú ÌèâÍ∑†",
            sum_good_snr: "Ïã†Ìò∏ ÌíàÏßà Ïö∞Ïàò", sum_ok_snr: "Ïã†Ìò∏ ÌíàÏßà ÏñëÌò∏", sum_bad_snr: "ÎÜíÏùÄ ÎÖ∏Ïù¥Ï¶à Í∞êÏßÄÎê®",
            sum_good_jit: "Îß§Ïö∞ ÏïàÏ†ïÏ†ÅÏù∏ ÌÅ¥Îü≠", sum_warn_jit: "ÏßÄÌÑ∞ Îã§ÏÜå ÎÜíÏùå",
            sum_good_rej: "Îç∞Ïù¥ÌÑ∞ Î¨¥Í≤∞ÏÑ± ÏôÑÎ≤Ω", sum_bad_rej: "Ìöå Ï∏°Ï†ï Í±∞Î∂ÄÎê®",
            perfect: "ÏôÑÎ≤Ω", warn: "Í≤ΩÍ≥†", normal: "Ï†ïÏÉÅ", inverted: "Î∞òÏ†ÑÎê®"
        },
        ru: {
            drop_title: "–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•", drop_sub: "–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª –ª–æ–≥–∞",
            stat_snr: "–°–†–ï–î–ù–ò–ô SNR", stat_jitter: "–î–ñ–ò–¢–¢–ï–† –°–ò–°–¢–ï–ú–´", stat_impulse: "–û–ë–©–ê–Ø –ó–ê–î–ï–†–ñ–ö–ê", stat_sub: "–ê–ö–¢–ò–í–ù–´–ï –°–ê–ë–í–£–§–ï–†–´", stat_rej: "–í–°–ï–ì–û –û–¢–ö–õ–û–ù–ï–ù–û",
            crit_title: "‚ñº –ü–û–ö–ê–ó–ê–¢–¨ –õ–û–ì–ò–ö–£ –û–¶–ï–ù–ö–ò",
            summary_title: "–°–≤–æ–¥–∫–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏",
            chart_accept: "–°—Ç–∞—Ç—É—Å –∏–∑–º–µ—Ä–µ–Ω–∏–π", chart_snr: "–£–ª—É—á—à–µ–Ω–∏–µ SNR",
            chart_avg_jitter: "–°—Ä–µ–¥–Ω–∏–π –¥–∂–∏—Ç—Ç–µ—Ä", chart_peak_jitter: "–ü–∏–∫–æ–≤—ã–π –¥–∂–∏—Ç—Ç–µ—Ä –∏ —á–∞—Å—Ç–æ—Ç–∞",
            chart_impulse: "–í—Ä–µ–º—è –∏–º–ø—É–ª—å—Å–∞",
            table_title: "–ü–æ–¥—Ä–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏",
            col_ch: "–ö–∞–Ω–∞–ª", col_status: "–°—Ç–∞—Ç—É—Å", col_acc: "–ü—Ä–∏–Ω.", col_rej: "–û—Ç–∫–ª.",
            col_base_snr: "–ë–∞–∑. SNR", col_final_snr: "–§–∏–Ω. SNR", col_gain: "–£—Å–∏–ª.",
            col_peak_jit: "–ü–∏–∫ –¥–∂–∏—Ç—Ç–µ—Ä", col_peak_freq: "–ü–∏–∫ —á–∞—Å—Ç.", col_avg_jit: "–°—Ä. –¥–∂–∏—Ç—Ç–µ—Ä",
            col_polarity: "–ü–æ–ª—è—Ä–Ω–æ—Å—Ç—å", col_impulse: "–ò–º–ø—É–ª—å—Å",
            row_sw: "–°–í–û–î–ö–ê –°–ê–ë–í–£–§–ï–†–ê", row_avg: "–°–†–ï–î–ù–ï–ï –ü–û –°–ò–°–¢–ï–ú–ï",
            sum_good_snr: "–û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–∞", sum_ok_snr: "–•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–∞", sum_bad_snr: "–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —à—É–º–∞",
            sum_good_jit: "–û—á–µ–Ω—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª–æ–∫", sum_warn_jit: "–î–∂–∏—Ç—Ç–µ—Ä –Ω–µ–º–Ω–æ–≥–æ –ø–æ–≤—ã—à–µ–Ω",
            sum_good_rej: "–ò–¥–µ–∞–ª—å–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å", sum_bad_rej: "–∏–∑–º–µ—Ä–µ–Ω–∏–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ",
            perfect: "–û–¢–õ–ò–ß–ù–û", warn: "–í–ù–ò–ú–ê–ù–ò–ï", normal: "–ù–æ—Ä–º–∞", inverted: "–ò–Ω–≤–µ—Ä—Å–∏—è"
        }
    };

    let currentLang = 'en';
    
    function setLanguage(lang) {
        currentLang = lang;
        document.body.className = `lang-${lang}`;
        document.querySelectorAll('.txt-render').forEach(el => {
            const key = el.getAttribute('data-key');
            el.innerHTML = renderText(key);
        });
        if(storedData) renderDashboard(storedData);
    }

    function renderText(key, suffix = "") {
        const primary = dict[currentLang][key] || key;
        const sub = dict['en'][key] || key;
        if (currentLang === 'en') return primary + suffix;
        return `<span class="lang-primary">${primary}${suffix}</span><span class="lang-sub">${sub}${suffix}</span>`;
    }

    function getTextRaw(key) {
        return dict[currentLang][key] || dict['en'][key];
    }

    // --- Theme Engine ---
    const themes = {
        dark_default: { bg: '#0f172a', panel: 'rgba(30, 41, 59, 0.7)', primary: '#38bdf8', secondary: '#818cf8', text: '#f1f5f9', sub: '#94a3b8', grid: 'rgba(255,255,255,0.05)', type: 'dark', row_sw: 'rgba(129, 140, 248, 0.1)', row_avg: 'rgba(56, 189, 248, 0.1)' },
        dark_onyx: { bg: '#000000', panel: 'rgba(20, 20, 20, 0.8)', primary: '#fbbf24', secondary: '#a855f7', text: '#e5e5e5', sub: '#737373', grid: 'rgba(255,255,255,0.08)', type: 'dark', row_sw: 'rgba(168, 85, 247, 0.1)', row_avg: 'rgba(251, 191, 36, 0.1)' },
        dark_forest: { bg: '#022c22', panel: 'rgba(6, 78, 59, 0.6)', primary: '#34d399', secondary: '#2dd4bf', text: '#ecfdf5', sub: '#6ee7b7', grid: 'rgba(255,255,255,0.05)', type: 'dark', row_sw: 'rgba(45, 212, 191, 0.1)', row_avg: 'rgba(52, 211, 153, 0.1)' },
        dark_amethyst: { bg: '#2e1065', panel: 'rgba(76, 29, 149, 0.5)', primary: '#d8b4fe', secondary: '#f472b6', text: '#faf5ff', sub: '#c084fc', grid: 'rgba(255,255,255,0.05)', type: 'dark', row_sw: 'rgba(244, 114, 182, 0.1)', row_avg: 'rgba(216, 180, 254, 0.1)' },
        dark_carbon: { bg: '#18181b', panel: 'rgba(39, 39, 42, 0.7)', primary: '#f87171', secondary: '#fb923c', text: '#f4f4f5', sub: '#a1a1aa', grid: 'rgba(255,255,255,0.05)', type: 'dark', row_sw: 'rgba(251, 146, 60, 0.1)', row_avg: 'rgba(248, 113, 113, 0.1)' },
        light_polar: { bg: '#f8fafc', panel: 'rgba(255, 255, 255, 0.8)', primary: '#0ea5e9', secondary: '#6366f1', text: '#0f172a', sub: '#64748b', grid: 'rgba(0,0,0,0.05)', type: 'light', row_sw: 'rgba(99, 102, 241, 0.1)', row_avg: 'rgba(14, 165, 233, 0.1)' },
        light_ceramic: { bg: '#f5f5f4', panel: 'rgba(255, 255, 255, 0.7)', primary: '#d97706', secondary: '#57534e', text: '#292524', sub: '#78716c', grid: 'rgba(0,0,0,0.05)', type: 'light', row_sw: 'rgba(87, 83, 78, 0.1)', row_avg: 'rgba(217, 119, 6, 0.1)' },
        light_mint: { bg: '#f0fdf4', panel: 'rgba(255, 255, 255, 0.8)', primary: '#10b981', secondary: '#14b8a6', text: '#064e3b', sub: '#059669', grid: 'rgba(0,0,0,0.05)', type: 'light', row_sw: 'rgba(20, 184, 166, 0.1)', row_avg: 'rgba(16, 185, 129, 0.1)' },
        light_lavender: { bg: '#faf5ff', panel: 'rgba(255, 255, 255, 0.8)', primary: '#9333ea', secondary: '#c026d3', text: '#4c1d95', sub: '#7c3aed', grid: 'rgba(0,0,0,0.05)', type: 'light', row_sw: 'rgba(192, 38, 211, 0.1)', row_avg: 'rgba(147, 51, 234, 0.1)' },
        light_steel: { bg: '#f1f5f9', panel: 'rgba(255, 255, 255, 0.9)', primary: '#334155', secondary: '#475569', text: '#0f172a', sub: '#475569', grid: 'rgba(0,0,0,0.08)', type: 'light', row_sw: 'rgba(71, 85, 105, 0.1)', row_avg: 'rgba(51, 65, 85, 0.1)' }
    };

    let currentTheme = themes.dark_default;
    let storedData = null;

    function applyTheme(themeKey) {
        currentTheme = themes[themeKey];
        const r = document.documentElement;
        r.style.setProperty('--bg-body', currentTheme.bg);
        r.style.setProperty('--bg-panel', currentTheme.panel);
        r.style.setProperty('--c-primary', currentTheme.primary);
        r.style.setProperty('--c-secondary', currentTheme.secondary);
        r.style.setProperty('--text-main', currentTheme.text);
        r.style.setProperty('--text-sub', currentTheme.sub);
        r.style.setProperty('--bg-sw-row', currentTheme.row_sw);
        r.style.setProperty('--bg-avg-row', currentTheme.row_avg);
        
        if (currentTheme.type === 'light') {
            r.style.setProperty('--bg-upload', 'rgba(255,255,255,0.5)');
            r.style.setProperty('--border-glass', 'rgba(0,0,0,0.08)');
            r.style.setProperty('--shadow-glow', 'rgba(0,0,0,0.05)');
            r.style.setProperty('--bg-table-head', 'rgba(0,0,0,0.03)');
            r.style.setProperty('--bg-table-hover', 'rgba(0,0,0,0.02)');
        } else {
            r.style.setProperty('--bg-upload', 'rgba(15, 23, 42, 0.3)');
            r.style.setProperty('--border-glass', 'rgba(255,255,255,0.08)');
            r.style.setProperty('--shadow-glow', `${currentTheme.primary}1A`);
            r.style.setProperty('--bg-table-head', `${currentTheme.primary}0D`);
            r.style.setProperty('--bg-table-hover', `${currentTheme.primary}08`);
        }

        Chart.defaults.color = currentTheme.sub;
        Chart.defaults.borderColor = currentTheme.grid;

        if (storedData) renderCharts(storedData);
    }

    // --- Main Logic ---
    const fileInput = document.getElementById('fileInput');
    const dropZone = document.getElementById('dropZone');

    dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.style.borderColor = 'var(--c-primary)'; dropZone.style.backgroundColor = 'var(--bg-table-head)'; });
    dropZone.addEventListener('dragleave', (e) => { e.preventDefault(); dropZone.style.borderColor = ''; dropZone.style.backgroundColor = ''; });
    dropZone.addEventListener('drop', (e) => { e.preventDefault(); if(e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]); });
    fileInput.addEventListener('change', (e) => { if(e.target.files.length) handleFile(e.target.files[0]); });

    function handleFile(file) {
        const reader = new FileReader();
        reader.onload = (e) => analyzeData(e.target.result);
        reader.readAsText(file);
    }

    function analyzeData(content) {
        const data = parseLog(content);
        if (data.length === 0) { alert("Invalid Log File"); return; }
        storedData = data;
        renderDashboard(data);
    }

    function parseLog(content) {
        const data = [];
        const chunks = content.split("----- Preparing to measure channel:");
        chunks.slice(1).forEach(chunk => {
            const channel = chunk.match(/^\s*(\w+)\s*-----/)?.[1];
            if (!channel) return;
            const acceptedMatch = chunk.match(/Accepted: (\d+)\/(\d+)/);
            const accepted = acceptedMatch ? parseInt(acceptedMatch[1]) : 0;
            const total = acceptedMatch ? parseInt(acceptedMatch[2]) : 0;
            
            let finalSnr = 0;
            const snrMatch = chunk.match(/Final SNR:\s*([\d.]+)\s*dB/);
            if (snrMatch) {
                finalSnr = parseFloat(snrMatch[1]);
            } else if (channel.startsWith("SW")) {
                const altSnrMatch = chunk.match(/SNR comparison:.*?median=([\d.]+)\s*dB/) || chunk.match(/SNR comparison:.*?mean=([\d.]+)\s*dB/);
                if (altSnrMatch) finalSnr = parseFloat(altSnrMatch[1]);
            }

            let baseSnr = 0;
            const baseSnrMatch = chunk.match(/Base SNR:\s*([\d.]+)\s*dB/);
            if (baseSnrMatch) baseSnr = parseFloat(baseSnrMatch[1]);
            else { const best = chunk.match(/Best single measurement:.*?SNR ([\d.]+)\s*dB/); if(best) baseSnr = parseFloat(best[1]); }
            
            const peakJitterMatch = chunk.match(/Peak Jitter:\s*(\d+)\s*us\s*@\s*([\d.]+)\s*Hz/);
            const peakJitter = peakJitterMatch ? parseInt(peakJitterMatch[1]) : 0;
            const peakFreq = peakJitterMatch ? parseFloat(peakJitterMatch[2]) : 0;
            const avgJitterMatch = chunk.match(/Average Jitter:\s*(\d+)\s*us/);
            const avgJitter = avgJitterMatch ? parseInt(avgJitterMatch[1]) : 0;
            const impulseMatch = chunk.match(/Estimated Impulse True Peak Time:\s*([\d.]+)\s*ms/);
            const impulseTime = impulseMatch ? parseFloat(impulseMatch[1]) : 0;
            
            let polarity = "Normal";
            if (chunk.includes("nverted") || chunk.includes("Reverse")) polarity = "Inverted";

            if (finalSnr > 0) data.push({ channel, accepted, total, rejected: total - accepted, baseSnr, finalSnr, peakJitter, peakFreq, avgJitter, impulseTime, polarity });
        });
        return data;
    }

    function renderDashboard(data) {
        document.getElementById('dashboard').classList.remove('hidden');
        
        // Filter out zero jitter entries for average calculation
        const validJit = data.filter(d => d.avgJitter > 0);
        const avgJit = validJit.length ? validJit.reduce((s,d)=>s+d.avgJitter,0)/validJit.length : 0;
        
        const avgSNR = data.reduce((s,d)=>s+d.finalSnr,0)/data.length;
        const totRej = data.reduce((s,d)=>s+d.rejected,0);
        const swCount = data.filter(d => d.channel.startsWith('SW')).length;
        const totImpulse = data.reduce((s,d)=>s+d.impulseTime,0);

        document.getElementById('val_avg_snr').innerText = avgSNR.toFixed(1) + " dB";
        document.getElementById('val_sys_jitter').innerText = avgJit.toFixed(0) + " us";
        document.getElementById('val_tot_rej').innerText = totRej;
        document.getElementById('val_sw_count').innerText = swCount;
        document.getElementById('val_tot_impulse').innerText = totImpulse.toFixed(1);

        let score = 100;
        if(avgSNR < 52) score -= (52 - avgSNR)*2;
        if(avgJit > 30) score -= (avgJit - 30)*0.5;
        score -= totRej;
        score = Math.max(0, Math.min(100, Math.round(score)));

        let rank = 'B'; if(score >= 95) rank = 'S CLASS'; else if(score >= 85) rank = 'A CLASS'; else if(score >= 75) rank = 'B CLASS'; else rank = 'C CLASS';

        document.getElementById('scoreValue').innerText = score;
        document.getElementById('rankBadge').innerText = rank;

        let summaryHTML = "";
        const sumItem = (icon, text) => `<div class="summary-item"><div class="summary-icon">${icon}</div><div>${text}</div></div>`;

        if(avgSNR > 52) summaryHTML += sumItem("üì∂", `<span class="zh txt-good">${getTextRaw('sum_good_snr')}</span><span class="en">Excellent Signal Quality (${avgSNR.toFixed(1)}dB avg).</span>`);
        else if(avgSNR > 48) summaryHTML += sumItem("üì∂", `<span class="zh txt-info">${getTextRaw('sum_ok_snr')}</span><span class="en">Good Signal Quality (${avgSNR.toFixed(1)}dB avg).</span>`);
        else summaryHTML += sumItem("‚ö†Ô∏è", `<span class="zh txt-bad">${getTextRaw('sum_bad_snr')}</span><span class="en">High Noise Floor Detected.</span>`);

        if(avgJit < 35) summaryHTML += sumItem("‚è±Ô∏è", `<span class="zh txt-good">${getTextRaw('sum_good_jit')}</span><span class="en">Rock Solid Clocking (${avgJit.toFixed(0)}us avg).</span>`);
        else summaryHTML += sumItem("‚ö†Ô∏è", `<span class="zh txt-warn">${getTextRaw('sum_warn_jit')}</span><span class="en">Jitter slightly elevated (${avgJit.toFixed(0)}us).</span>`);

        if(totRej === 0) summaryHTML += sumItem("üõ°Ô∏è", `<span class="zh txt-good">${getTextRaw('sum_good_rej')}</span><span class="en">Perfect Data Integrity.</span>`);
        else summaryHTML += sumItem("üå©Ô∏è", `<span class="zh txt-bad">${totRej} ${getTextRaw('sum_bad_rej')}</span><span class="en">${totRej} measurements rejected.</span>`);

        document.getElementById('summaryText').innerHTML = summaryHTML;
        renderCharts(data);
        renderTable(data);
    }

    let charts = {};
    function renderCharts(data) {
        const labels = data.map(d => d.channel);
        const options = { 
            responsive: true, maintainAspectRatio: false, 
            plugins: { legend: { labels: { color: currentTheme.sub } } },
            scales: {
                x: { grid: { color: currentTheme.grid }, ticks: { color: currentTheme.sub } },
                y: { grid: { color: currentTheme.grid }, ticks: { color: currentTheme.sub } }
            }
        };

        const createChart = (id, type, cfg) => {
            if(charts[id]) charts[id].destroy();
            charts[id] = new Chart(document.getElementById(id), { type, data: cfg.data, options: { ...options, ...cfg.options } });
        };

        createChart('chartAccept', 'bar', { data: { labels, datasets: [ { label: 'Accepted', data: data.map(d=>d.accepted), backgroundColor: '#4ade80' }, { label: 'Rejected', data: data.map(d=>d.rejected), backgroundColor: '#f87171' } ] }, options: { scales: { x: { stacked: true }, y: { stacked: true } } } });
        createChart('chartSNR', 'bar', { data: { labels, datasets: [ { label: 'Base SNR', data: data.map(d=>d.baseSnr), backgroundColor: 'rgba(128,128,128,0.3)' }, { label: 'Final SNR', data: data.map(d=>d.finalSnr), backgroundColor: currentTheme.primary, borderColor: currentTheme.primary, borderWidth: 1 } ] }, options: { scales: { y: { min: 10 } } } });
        createChart('chartAvgJitter', 'bar', { data: { labels, datasets: [{ label: 'Avg Jitter (us)', data: data.map(d=>d.avgJitter), backgroundColor: data.map(d => d.avgJitter < 40 ? '#4ade80' : (d.avgJitter < 70 ? '#fbbf24' : '#f87171')) }] } });
        createChart('chartPeakJitter', 'bar', { data: { labels, datasets: [ { label: 'Peak Jitter (us)', data: data.map(d=>d.peakJitter), backgroundColor: currentTheme.secondary, yAxisID: 'y' }, { type: 'line', label: 'Frequency (Hz)', data: data.map(d=>d.peakFreq), borderColor: currentTheme.primary, yAxisID: 'y1' } ] }, options: { scales: { y: { position: 'left', title: {display:true, text:'us', color:currentTheme.sub} }, y1: { position: 'right', grid: {drawOnChartArea:false}, title: {display:true, text:'Hz', color:currentTheme.sub} } } } });
        createChart('chartImpulse', 'line', { data: { labels, datasets: [{ label: 'Impulse Time (ms)', data: data.map(d=>d.impulseTime), borderColor: currentTheme.success || '#4ade80', backgroundColor: 'rgba(74, 222, 128, 0.1)', fill: true, tension: 0.3 }] } });
    }

    function renderTable(data) {
        const tbody = document.querySelector('#dataTable tbody');
        tbody.innerHTML = '';
        
        data.forEach(d => {
            const tr = document.createElement('tr');
            const gain = d.finalSnr - d.baseSnr;
            
            // Multilingual Channel Name Logic
            let chName = d.channel;
            if (channelNames[d.channel]) {
                chName = channelNames[d.channel][currentLang] || channelNames[d.channel]['en'];
            } else if (d.channel.startsWith('SW')) {
                const num = d.channel.replace('SW', '');
                const base = channelNames['SW'][currentLang] || channelNames['SW']['en'];
                chName = `${base} ${num}`;
            }

            const statusBadge = d.rejected === 0 
                ? `<span class="badge" style="background:${currentTheme.type==='dark'?'rgba(74,222,128,0.1)':'#dcfce7'}; color:#16a34a; border:1px solid #16a34a">${getTextRaw('perfect')}</span>`
                : `<span class="badge" style="background:${currentTheme.type==='dark'?'rgba(251,191,36,0.1)':'#fef9c3'}; color:#d97706; border:1px solid #d97706">${getTextRaw('warn')}</span>`;

            tr.innerHTML = `
                <td>
                    <span class="lang-primary">${chName}</span>
                    <span class="lang-sub" style="color:var(--c-primary); font-weight:bold;">${d.channel}</span>
                </td>
                <td>${statusBadge}</td>
                <td><span style="color:var(--text-main)">${d.accepted}</span> / <span style="color:var(--text-sub)">${d.total}</span></td>
                <td style="color:${d.rejected>0?'var(--c-danger)':'var(--text-sub)'}">${d.rejected}</td>
                <td>${d.baseSnr.toFixed(1)}</td>
                <td style="color:var(--c-primary); font-weight:bold;">${d.finalSnr.toFixed(1)}</td>
                <td style="color:${gain>=0?'var(--c-success)':'var(--c-danger)'}">${gain>=0?'+':''}${gain.toFixed(1)}</td>
                <td>${d.peakJitter}</td>
                <td class="mono" style="color:var(--c-secondary)">${d.peakFreq}</td>
                <td style="color:${d.avgJitter<40?'var(--c-success)':(d.avgJitter<70?'var(--c-warning)':'var(--c-danger)')}; font-weight:bold;">${d.avgJitter}</td>
                <td>${d.polarity === 'Normal' ? getTextRaw('normal') : `<span style="color:var(--c-danger)">${getTextRaw('inverted')}</span>`}</td>
                <td class="mono">${d.impulseTime.toFixed(3)}</td>
            `;
            tbody.appendChild(tr);
        });

        const swData = data.filter(d => d.channel.includes("SW"));
        const avg = (arr, key) => {
            if (key === 'peakJitter' || key === 'avgJitter') {
                const valid = arr.filter(d => d[key] > 0);
                return valid.length ? valid.reduce((a,b)=>a+b[key],0)/valid.length : 0;
            }
            return arr.length ? arr.reduce((a,b)=>a+b[key],0)/arr.length : 0;
        };
        
        const renderSummary = (className, titleKey, sourceData) => {
            if (sourceData.length === 0) return;
            const tr = document.createElement('tr');
            tr.className = className;
            const mBase = avg(sourceData, 'baseSnr').toFixed(1);
            const mFinal = avg(sourceData, 'finalSnr').toFixed(1);
            const mGain = (mFinal - mBase).toFixed(1);
            const mPkJit = avg(sourceData, 'peakJitter').toFixed(0);
            const mAvgJit = avg(sourceData, 'avgJitter').toFixed(0);
            const mImp = avg(sourceData, 'impulseTime').toFixed(3);
            tr.innerHTML = `<td colspan="4" style="text-align:right; padding-right:20px;">${renderText(titleKey)}</td><td>${mBase}</td><td>${mFinal}</td><td>${mGain}</td><td>${mPkJit}</td><td>-</td><td>${mAvgJit}</td><td>-</td><td>${mImp}</td>`;
            tbody.appendChild(tr);
        };

        if(swData.length > 0) renderSummary('row-sw', 'row_sw', swData);
        renderSummary('row-avg', 'row_avg', data);
    }

    applyTheme('dark_default');
    setLanguage('en'); 
</script>

</body>
</html>